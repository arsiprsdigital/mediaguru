<!DOCTYPE html>
<html lang="en">
<head>
     <title>Edu Media 24</title>
     <meta charset="UTF-8">
     <meta http-equiv="X-UA-Compatible" content="IE=Edge">
     <meta name="description" content="">
     <meta name="keywords" content="">
     <meta name="author" content="">
     <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
     <link rel="icon" type="image/x-icon" href="https://lh3.googleusercontent.com/Y2s3-UAARJ1v4GQip9MJxf65Sh1Ac5aYrv7c8ptFis-fVguNyXesqYLUFZNIJ299uZJ05vECKPtXGlej9w" />
     <link rel="stylesheet" href="css/bootstrap.min.css">
     <link rel="stylesheet" href="css/magnific-popup.css">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
     <link rel="stylesheet" href="css/templatemo-style.css">
</head>
<body>
     <section class="preloader">
          <div class="spinner">
               <span class="spinner-rotate"></span>
          </div>
     </section>
     <section class="navbar custom-navbar navbar-fixed-top" role="navigation">
          <div class="container">
               <div class="navbar-header">
                    <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                         <span class="icon icon-bar"></span>
                         <span class="icon icon-bar"></span>
                         <span class="icon icon-bar"></span>
                    </button>
                     <a href="index.html" class="navbar-brand" style="display: flex; align-items: center; padding-top: 10px; padding-bottom: 10px;">
                      <img src="https://lh3.googleusercontent.com/Y2s3-UAARJ1v4GQip9MJxf65Sh1Ac5aYrv7c8ptFis-fVguNyXesqYLUFZNIJ299uZJ05vECKPtXGlej9w" alt="Logo" 
                           style="height: 40px; margin-right: 8px; vertical-align: middle;">
                      <span>SMPN 24 PPU</span>
                    </a>
                </div>
               <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-nav-first">
                         <li><a href="#home" class="smoothScroll">Home</a></li>
                         <li><a href="#about" class="smoothScroll">About</a></li>
                         <li><a href="#portfolio" class="smoothScroll">Portfolio</a></li>
                         <li><a href="#services" class="smoothScroll">Services</a></li>
                         <li><a href="#contact" class="smoothScroll">Contacts</a></li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                         <li><a href="https://web.facebook.com" target="_blank"><i class="fa-brands fa-facebook-square"></i></a></li>
                         <li><a href="https://x.com" target="_blank"><i class="fa-brands fa-twitter"></i></a></li>
                         <li><a href="https://www.instagram.com/accounts/login" target="_blank"><i class="fa-brands fa-instagram"></i></a></li>
                         <li><a href="https://www.youtube.com" target="_blank"><i class="fa-brands fa-youtube"></i></a></li>
                         <li class="section-btn"><a href="admin.html" target="_blank">Sign in</a></li>
                    </ul>
               </div>
          </div>
     </section>

     <!-- HOME -->
     <section id="home" data-stellar-background-ratio="0.5">
          <div class="overlay"></div>
          <div class="container">
               <div class="row">
                    <div class="col-md-6 col-sm-12">
                         <div class="home-info">
                              <h1 id="subTitle"></h1>
                              <a href="#about" class="btn section-btn smoothScroll">Explore More</a>
                              <span>
                                   <small>For more information</small>
                              </span>
                         </div>
                    </div>

                   <div class="col-md-6 col-sm-12">
                      <div class="home-video position-relative">
                        <div class="embed-responsive embed-responsive-16by9">
                         <a href="https://www.youtube.com/watch?v=" target="_blank" class="d-block position-relative">
                            <img src="" 
                                 class="embed-responsive-item img-fluid" 
                                 alt="SMPN 24 PPU - Tonton di YouTube">
                            <div style="
                              position:absolute;
                              top:50%;
                              left:50%;
                              transform:translate(-50%, -50%);
                              font-size:50px;
                              color:#fff;
                              text-shadow:0 0 25px rgba(0,0,0,0.6);
                              ">
                              <i class="fa fa-play-circle"></i>
                            </div>
                          </a>
                        </div>
                      </div>
                    </div>
               </div>
          </div>
     </section>


     <!-- ABOUT -->
     <section id="about" data-stellar-background-ratio="0.5">
       <div class="container">
         <div class="row">
           <div class="col-md-8 col-sm-6">
             <div class="about-info">
               <div class="section-title">
                 <h2 id="about-title">Loading...</h2>
                 <span class="line-bar">...</span>
               </div>
               <p id="about-desc1"></p>
               <p id="about-desc2"></p>
             </div>
           </div>
           <div class="col-md-4 col-sm-12">
             <div class="about-image">
               <img id="about-img" src="" class="img-responsive" alt="">
               <h4 id="about-name" style="margin-top:10px; text-align: center; font-weight:600; font-size: 16px; color:#333;">
             </div>
           </div>
         </div>
       </div>
     </section>


     <section id="portfolio" data-stellar-background-ratio="0.5">
       <div class="container">
         <div class="row">
           <div class="col-md-12 col-sm-12">
             <div class="section-title">
               <h2>Portfolio</h2>
               <span class="line-bar">...</span>
             </div>
           </div>
         </div>
         <div class="row" id="portfolio-container"></div>
       </div>
     </section>

    <!-- SERVICES SECTION -->
    <section id="services" data-stellar-background-ratio="0.5">
      <div class="container">
        <div class="row">
          <div class="col-md-12 col-sm-12">
            <div class="section-title">
              <h2>What I Do</h2>
              <span class="line-bar">...</span>
            </div>
          </div>
        </div>
        <div class="row" id="services-container">
        </div>
      </div>
    </section>

     <!-- CONTACT -->
     <section id="contact" data-stellar-background-ratio="0.5">
          <div class="container">
               <div class="row">

                    <div class="col-md-12 col-sm-12">
                         <div class="section-title">
                              <h2>Get in Touch</h2>
                              <span class="line-bar">...</span>
                         </div>
                    </div>

                    <div class="col-md-8 col-sm-8">
                         <form id="contact-form" role="form" action="#" method="post">
                              <div class="col-md-6 col-sm-6">
                                   <input type="text" class="form-control" placeholder="Full Name" id="cf-name" name="cf-name" required="">
                              </div>

                              <div class="col-md-6 col-sm-6">
                                   <input type="text" class="form-control" placeholder="Your Address" id="cf-address" name="cf-address" required="">
                              </div>

                              <div class="col-md-6 col-sm-6">
                                   <input type="email" class="form-control" placeholder="Your Email" id="cf-email" name="cf-email" required="">
                              </div>

                              <div class="col-md-6 col-sm-6">
                                   <input type="tel" class="form-control" placeholder="Your Phone" id="cf-number" name="cf-number" required="">
                              </div>

                              <div class="col-md-12 col-sm-12">
                                   <textarea class="form-control" rows="6" placeholder="Your Message" id="cf-message" name="cf-message" required=""></textarea>
                              </div>

                              <div class="col-md-4 col-sm-12">
                                   <input type="submit" class="form-control" name="submit" value="Send Message">
                              </div>

                         </form>
                    </div>

                    <div class="col-md-4 col-sm-4">
                         <div class="google-map">
                              <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3989.0368462988695!2d116.54342417509292!3d-1.1340323354789228!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2df12d17e152f793%3A0x29cc70493d40e9cd!2sSMP%20Negeri%2024%20Penajam%20Paser%20Utara!5e0!3m2!1sid!2sid!4v1759485988174!5m2!1sid!2sid" allowfullscreen></iframe>
                         </div>
                    </div>

               </div>
          </div>
     </section>


    <!-- FOOTER -->
     <footer data-stellar-background-ratio="0.5" style="background:#222; color:#fff; padding:40px 0;">
       <div class="container">
         <div class="row">

           <!-- Info -->
           <div class="col-md-5 col-sm-12">
             <div class="footer-thumb footer-info"> 
               <h2>Edu Media 24</h2>
               <p></p>
             </div>
           </div>

           <!-- Quick Links -->
           <div class="col-md-2 col-sm-4"> 
             <div class="footer-thumb"> 
               <h2>Quick Links</h2>
               <ul class="footer-link">
                 <li><a href="#about">About</a></li>
                 <li><a href="#portfolio">Portfolio</a></li>
                 <li><a href="#services">Services</a></li>
                 <li><a href="#contact">Contact</a></li>
               </ul>
             </div>
           </div>

           <!-- Services -->
           <div class="col-md-2 col-sm-4"> 
             <div class="footer-thumb"> 
               <h2>Services</h2>
               <ul class="footer-link">
                 <li><a href="#">Learning Media</a></li>
                 <li><a href="#">Workshops & Training</a></li>
                 <li><a href="#">Consultation</a></li>
               </ul>
             </div>
           </div>

           <!-- Contact -->
           <div class="col-md-3 col-sm-4"> 
             <div class="footer-thumb"> 
               <h2>Contact Us</h2>
               <p>SMP Negeri 24 Penajam Paser Utara <br>Bukit Subur, Penajam, East Kalimantan</p>
               <p>Phone: </p>
               <p>Email: </p>
             </div>
           </div>                    

           <!-- Bottom -->
           <div class="col-md-12 col-sm-12">
             <div class="footer-bottom" style="border-top:1px solid #444; margin-top:20px; padding-top:15px;">
               <div class="col-md-6 col-sm-6">
                 <div class="copyright-text"> 
                   <p>Copyright &copy; 2025 Edu Media 24. All rights reserved.</p>
                 </div>
               </div>
               <div class="col-md-6 col-sm-6">
                 <ul class="social-icon" style="list-style:none; margin:0; padding:0;">
                   <li style="display:inline-block; margin:0 5px;">
                     <a href="https://www.facebook.com" class="fa-brands fa-facebook-square" target="_blank"></a>
                   </li>
                   <li style="display:inline-block; margin:0 5px;">
                     <a href="https://twitter.com" class="fa-brands fa-twitter" target="_blank"></a>
                   </li>
                   <li style="display:inline-block; margin:0 5px;">
                     <a href="https://instagram.com" class="fa-brands fa-instagram" target="_blank"></a>
                   </li>
                   <li style="display:inline-block; margin:0 5px;">
                     <a href="https://youtube.com" class="fa-brands fa-youtube" target="_blank"></a>
                   </li>
                 </ul>
               </div>
             </div>
           </div>
         </div>
       </div>
     </footer>

     <script src="https://code.jquery.com/jquery-latest.min.js"></script>
     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/stellar.js/0.6.2/jquery.stellar.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
     <script src="js/custom.js"></script>
     <script>
      const SHEET_ID = "1bzoQJDDYcRw6Tz_xJT7k8Xa5dc-tBX4pcDGfG7Gh5DM";
      const BASE_URL = `https://opensheet.elk.sh/${1bzoQJDDYcRw6Tz_xJT7k8Xa5dc-tBX4pcDGfG7Gh5DM}`;
      const homeSheetURL = `${BASE_URL}/Home`;
      const portfolioURL = `${BASE_URL}/Portfolio`;
      const layananSheetURL = `${BASE_URL}/Layanan`;
      const aboutSheetURL = `${BASE_URL}/About`;
      let scriptURL = "";

      fetch(aboutSheetURL)
        .then(res => res.json())
        .then(rows => {
          if (!rows.length) throw new Error("Data kosong!");
          const data = rows[0];
          document.getElementById("about-title").innerText = data["Judul"] || "No Title";
          document.getElementById("about-desc1").innerText = data["Deskripsi 1"] || "";
          document.getElementById("about-desc2").innerText = data["Deskripsi 2"] || "";

          const detailBtn = `
            <div class="mt-3" style="margin-top:20px">
              <a href="personal.html" class="btn btn-primary">
                <i class="fa fa-user"></i> View Details
              </a>
            </div>
          `;
          
          document.getElementById("about-desc2").insertAdjacentHTML("afterend", detailBtn);

          let fotoUrl = data["Foto"] || "";
          if (fotoUrl.includes("drive.google.com")) {
            const idMatch = fotoUrl.match(/[-\w]{25,}/);
            if (idMatch) fotoUrl = `https://drive.google.com/thumbnail?export=view&id=${idMatch[0]}`;
          }
          const aboutImg = document.getElementById("about-img");
          aboutImg.src = fotoUrl || "images/default-profile.jpg";
          aboutImg.alt = data["Nama Guru"] || "Profile Image";
          document.getElementById("about-name").innerText = data["Nama Guru"] || "No Name";
        })
        .catch(err => console.error("Gagal ambil data ABOUT:", err));

       // 🔹 PORTFOLIO SECTION
 
       fetch(portfolioURL)
        .then(res => res.json())
        .then(rows => {
          const container = document.getElementById("portfolio-container");
          container.innerHTML = "";
          rows.forEach((item, index) => {
            const kategori = item["Kategori Portfolio"] || "";
            const judul = item["Judul Portfolio"] || "No Title";
            const deskripsi = item["Deskripsi Portfolio"] || "";
            let thumb = item["Thumbnail Portfolio"] || "images/default-thumb.jpg";
            if (thumb.includes("drive.google.com")) {
              const idMatch = thumb.match(/[-\w]{25,}/);
              if (idMatch) thumb = `https://drive.google.com/thumbnail?export=view&id=${idMatch[0]}`;
            }

            const linkDetail = `modul_${index + 1}.html`;
            const html = `
              <div class="col-md-6 col-sm-6 mb-4">
                <div class="media portfolio-thumb shadow-sm rounded overflow-hidden">
                  <div class="media-object media-left">
                    <a href="${linkDetail}">
                      <img src="${thumb}" 
                           onerror="this.src='images/default-thumb.jpg'" 
                           class="img-responsive" 
                           alt="${judul}" 
                           style="width:100%; height:100%; max-height:300px">
                    </a>
                  </div>
                  <div class="media-body portfolio-info p-3">
                    <small><i class="fa fa-folder-open"></i> ${kategori}</small>
                    <h3><a href="${linkDetail}">${judul}</a></h3>
                    <p>${deskripsi}</p>
                    <a href="${linkDetail}" class="btn section-btn">View Details</a>
                  </div>
                </div>
              </div>
            `;
            container.insertAdjacentHTML("beforeend", html);
          });
        })
        .catch(err => console.error("Gagal ambil Portfolio:", err));


      // 🔹 HOME SECTION

      fetch(homeSheetURL)
        .then(res => res.json())
        .then(rows => {
          if (rows[1] && rows[1]["Title"] && rows[1]["Title"].startsWith("https://script.google.com")) {
            scriptURL = rows[1]["Title"].trim();
            console.log("✅ URL Apps Script ditemukan:", scriptURL);
          } else {
            console.error("URL tidak ditemukan");
          }

          if (rows.length > 0) {
            const data = rows[0];
            const title = data["Title"] || "";
            const call = data["Call"] || "";
            const thumbnail = data["Youtube-Thumbnail"] || "";
            const youtubeId = data["URL ID Yotube"] || "";
            const email = data["Email Address"] || "";
            const footerDesc = data["Footer Description"] || "";

            document.getElementById("subTitle").textContent = title;
            const callSpan = document.querySelector(".home-info span");
            if (callSpan) callSpan.innerHTML = `${call} <small>For more information</small>`;

            const ytLink = document.querySelector(".home-video a");
            const ytImg = document.querySelector(".home-video img");
            if (ytLink && ytImg) {
              ytLink.href = `https://www.youtube.com/watch?v=${youtubeId}`;
              ytImg.src = thumbnail;
            }

            const footerPhone = document.querySelector(".footer-thumb p:nth-of-type(2)");
            const footerEmail = document.querySelector(".footer-thumb p:nth-of-type(3)");
            if (footerPhone) footerPhone.textContent = "Phone: " + call.replace("CALL US ", "");
            if (footerEmail) footerEmail.textContent = "Email: " + email;
            const footerInfo = document.querySelector(".footer-info p");
            if (footerInfo) footerInfo.textContent = footerDesc;
          }
        })
        .catch(err => console.error("Gagal ambil data HOME:", err));


      // 🔹 LAYANAN SECTION

      fetch(layananSheetURL)
        .then(res => res.json())
        .then(rows => {
          const container = document.getElementById("services-container");
          container.innerHTML = "";
          rows.forEach(item => {
            const judul = item["Judul Layanan"] || "Tanpa Judul";
            const deskripsi = item["Deskripsi Layanan"] || "";
            const link = item["Link Layanan"] || "#";
            let gambar = item["Gambar Layanan"] || "images/default-thumb.jpg";
            if (gambar.includes("drive.google.com")) {
              const idMatch = gambar.match(/[-\w]{25,}/);
              if (idMatch) gambar = `https://drive.google.com/thumbnail?export=view&id=${idMatch[0]}`;
            }

            const html = `
              <div class="col-md-3 col-sm-6">
                <div class="services-thumb">
                  <a href="${link}" target="_blank" rel="noopener noreferrer">
                    <img src="${gambar}" class="img-responsive" alt="${judul}" onerror="this.src='images/default-thumb.jpg'">
                    <div class="services-info">
                      <h3>${judul}</h3>
                      <small>${deskripsi}</small>
                    </div>
                  </a>
                </div>
              </div>
            `;
            container.insertAdjacentHTML("beforeend", html);
          });
        })
        .catch(err => console.error("Gagal ambil data Layanan:", err));

      // 🔹 CONTACT FORM

      document.getElementById("contact-form").addEventListener("submit", function(e) {
        e.preventDefault();
        const submitBtn = this.querySelector("input[type='submit']");
        submitBtn.value = "Sending...";
        submitBtn.disabled = true;

        const formData = {
          "cf-name": document.getElementById("cf-name").value,
          "cf-address": document.getElementById("cf-address").value,
          "cf-email": document.getElementById("cf-email").value,
          "cf-number": document.getElementById("cf-number").value,
          "cf-message": document.getElementById("cf-message").value
        };

        if (!scriptURL) {
          alert("⚠️ URL belum siap. Tunggu beberapa detik.");
          submitBtn.value = "Send Message";
          submitBtn.disabled = false;
          return;
        }

        fetch(scriptURL, { method: "POST", body: JSON.stringify(formData) })
          .then(res => res.json())
          .then(data => {
            if (data.result === "success") {
              document.getElementById("contact-form").reset();
              const msg = document.createElement("p");
              msg.textContent = "✅ Pesan berhasil dikirim!";
              msg.style.color = "white";
              msg.style.marginTop = "10px";
              msg.id = "successMsg";
              submitBtn.insertAdjacentElement("afterend", msg);
              setTimeout(() => msg.remove(), 5000);
            } else {
              alert("Gagal mengirim pesan ke server.");
            }
          })
          .catch(err => {
            console.error("Error:", err);
            alert("⚠️ Error saat mengirim data. Periksa koneksi internet Anda.");
          })
          .finally(() => {
            submitBtn.value = "Send Message";
            submitBtn.disabled = false;
          });
      });
</script>
</body>
</html>
